import requests

s = requests.Session()
s.headers["User-Agent"] = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/" \
                          "83.0.4103.106 Safari/537.36"


def is_vulnerable(response):
    """A simple boolean function that determines whether a page
    is SQL Injection vulnerable from its `response`"""
    errors = {
        # MySQL
        "you have an error in your sql syntax;",
        "warning: mysql",
        # SQL Server
        "unclosed quotation mark after the character string",
        # Oracle
        "quoted string not properly terminated",
    }
    for error in errors:
        # if you find one of these errors, return True
        if error in response.content.decode().lower():
            return True
    # no error detected
    return False


def scan_sql_injection(url):
    # test on URL + "'"
    res = s.get(url + "'")
    if is_vulnerable(res):
        print("SQL Injection vulnerability detected")
    else:
        print("Vulnerability wasn't detected")


if __name__ == "__main__":
    url_to_check = input("Enter url to check: ")  # http://testphp.vulnweb.com/artists.php?artist=3 url example
    scan_sql_injection(url_to_check)
